# 第一步
## 安装并配置环境
1. 初始化一个全新的 Next.js 项目，命令：`pnpm create next-app@latest`
2. 安装最新版的 RainbowKit 钱包连接组件库到项目中。命令：`pnpm add @rainbow-me/rainbowkit@latest`
3. 将 wagmi、viem（2.x 版本）和 @tanstack/react-query 这三个依赖包安装到你的项目中。命令:`pnpm add wagmi viem@2.x @tanstack/react-query`
4. 引入wagmi核心组件库。命令：`pnpm add @wagmi/core viem@2.x` 
5. 引入图标库。命令：`pnpm add react-icons`
6. 引入测试库。命令：`pnpm add -D vitest`

# 配置测试环境
## 1.引入依赖
引入测试库。命令：`pnpm add -D vitest`

引入tsconfig: `pnpm add -D vite-tsconfig-paths`
## 2.配置
配置见：vitest.config.mts文件。
`vitest.config.mts` 是 Vitest 的**配置文件**，用于自定义和优化前端项目的单元测试环境。  
下面是对该文件的整体作用和每一项配置的详细解释：

---

## 1. 文件整体作用

- 该文件通过 `defineConfig` 导出 Vitest 的测试配置，帮助你定制测试行为、插件、依赖处理、测试环境等。
- 让 Vitest 能更好地适配你的项目结构（如路径别名）、依赖、测试目录等。

---

## 2. 每一项配置的作用

```ts
import { defineConfig } from 'vitest/config'
import tsconfigPaths from 'vite-tsconfig-paths'
```
- **`defineConfig`**：Vitest 提供的配置函数，能获得类型提示和更好的 IDE 支持。
- **`tsconfigPaths`**：Vite 插件，用于自动识别 `tsconfig.json` 里的路径别名（如 `@/utils`），让测试代码能正确解析这些别名。

---

```ts
export default defineConfig({
    plugins: [tsconfigPaths()],
```
- **`plugins`**：配置 Vite/Vitest 插件，这里用 `tsconfigPaths` 让路径别名生效。

---

```ts
    test: {
        environment: 'jsdom',
        exclude: ['**/node_modules/**', '**/test/**', 'playwright-report/**', 'test-results/**'],
        deps: {
            inline: ['wagmi', '@wagmi/core']
        }
    },
```
- **`test`**：Vitest 的测试相关配置对象。

  - **`environment: 'jsdom'`**  
    指定测试运行环境为 `jsdom`，模拟浏览器环境，适合测试涉及 DOM 的前端代码（如 React 组件）。

  - **`exclude: [...]`**  
    指定 Vitest 在运行测试时要排除的目录或文件模式。  
    - `**/node_modules/**`：排除依赖包
    - `**/test/**`、`playwright-report/**`、`test-results/**`：排除自定义测试目录和测试报告目录

  - **`deps: { inline: [...] }`**  
    指定哪些依赖需要被内联处理（即不走外部依赖优化，直接打包进测试环境）。  
    - 这里 `['wagmi', '@wagmi/core']` 是因为这些包可能用到 ESM 特性或需要特殊处理，内联后能避免测试环境下的兼容性问题。

---

## 3. 总结

- **整体作用**：让 Vitest 测试环境适配你的项目结构、依赖和前端特性，保证测试能顺利运行。
- **每一项**：
  - `plugins`：支持路径别名
  - `environment`：指定测试环境
  - `exclude`：排除不需要测试的目录
  - `deps.inline`：特殊依赖内联处理，提升兼容性

# 优化点
1. 点击提交时应该有一个旋转等待交易完成的图标在按钮内
2. 刷新页面时表单内容能保持不被清空
3. 在底部显示交易详情卡片，并且金额会多个累加